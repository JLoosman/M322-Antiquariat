<link rel="stylesheet" href="css/bookCard.css">

<?php
    // choose a random image from the img/cover directory
    $imgDir = "img/cover/";
    $images = glob($imgDir . "*.{jpg, jpeg, png}", GLOB_BRACE);
    $randImg = $images[array_rand($images)];

    // store the current prices into a session variable to make it persistant
    if(isset($_SESSION["prices"])) {
        $count = $id % 12;
    } else {
        $priceArr = [];
        for($i = 0; $i < 12; $i++) {
            $priceArr[$i] = rand(10, 90);
        }
        $_SESSION["prices"] = $priceArr;
        $count = $id % 12;
    }
?>

<div class="cardContainer">
    <a href="book.php?id=<?=$id?>&img=<?=$randImg?>" class="card">
        <img src="<?=$randImg?>" alt="Cover of a book" class="cover">
        <p class="title"><?=$title?></p>
        <small class="author"><?=$author?></small>
        <h4>CHF <?=$_SESSION["prices"][$count]?>.00</h4>
    </a>
    <?php
        if(isset($_SESSION["loggedIn"]) && $_SESSION["loggedIn"] == true) {
            echo
            '
            <a href="editbook.php?id=<?=$id?>" class="edit fadeIn">
                <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="20" cy="20" r="19" fill="#434343" stroke="#F0F0F0" stroke-width="2"/>
                    <path d="M31.3333 14.1129C31.3342 13.9594 31.3048 13.8072 31.2467 13.665C31.1887 13.5229 31.1031 13.3936 30.995 13.2846L26.0483 8.33833C25.9393 8.23021 25.81 8.14467 25.6679 8.08661C25.5257 8.02856 25.3735 7.99913 25.22 8.00002C25.0664 7.99913 24.9142 8.02856 24.7721 8.08661C24.63 8.14467 24.5007 8.23021 24.3917 8.33833L21.09 11.6397L8.33835 24.3905C8.23022 24.4995 8.14468 24.6287 8.08662 24.7709C8.02856 24.913 7.99913 25.0652 8.00002 25.2187V30.165C8.00002 30.4744 8.12294 30.7712 8.34173 30.9899C8.56052 31.2087 8.85727 31.3316 9.16668 31.3316H14.1133C14.2766 31.3405 14.4399 31.315 14.5926 31.2567C14.7454 31.1984 14.8842 31.1087 15 30.9933L27.6817 18.2426L30.995 14.9995C31.1015 14.8864 31.1882 14.7563 31.2516 14.6145C31.2629 14.5215 31.2629 14.4275 31.2516 14.3345C31.2571 14.2802 31.2571 14.2255 31.2516 14.1712L31.3333 14.1129ZM13.635 28.9985H10.3333V25.697L21.9183 14.1129L25.22 17.4143L13.635 28.9985ZM26.865 15.7694L23.5633 12.468L25.22 10.8231L28.51 14.1129L26.865 15.7694Z" fill="#F0F0F0"/>
                </svg>
            </a>
            <a href="deletebook.php?id=<?=$id?>" class="delete fadeIn">
                <svg width="30" height="30" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="20" cy="20" r="19" fill="#434343" stroke="#F0F0F0" stroke-width="2"/>
                    <path d="M17.5934 26.868C17.9008 26.868 18.1957 26.7459 18.4131 26.5284C18.6306 26.311 18.7527 26.0161 18.7527 25.7087V18.7527C18.7527 18.4452 18.6306 18.1503 18.4131 17.9329C18.1957 17.7155 17.9008 17.5933 17.5934 17.5933C17.2859 17.5933 16.991 17.7155 16.7736 17.9329C16.5562 18.1503 16.434 18.4452 16.434 18.7527V25.7087C16.434 26.0161 16.5562 26.311 16.7736 26.5284C16.991 26.7459 17.2859 26.868 17.5934 26.868ZM29.1867 12.956H24.5494V11.7967C24.5494 10.8742 24.1829 9.9896 23.5307 9.33735C22.8784 8.6851 21.9938 8.31866 21.0714 8.31866H18.7527C17.8303 8.31866 16.9456 8.6851 16.2934 9.33735C15.6411 9.9896 15.2747 10.8742 15.2747 11.7967V12.956H10.6374C10.3299 12.956 10.035 13.0781 9.81759 13.2956C9.60017 13.513 9.47803 13.8079 9.47803 14.1153C9.47803 14.4228 9.60017 14.7177 9.81759 14.9351C10.035 15.1525 10.3299 15.2747 10.6374 15.2747H11.7967V28.0273C11.7967 28.9498 12.1631 29.8344 12.8154 30.4866C13.4676 31.1389 14.3523 31.5053 15.2747 31.5053H24.5494C25.4718 31.5053 26.3564 31.1389 27.0087 30.4866C27.6609 29.8344 28.0274 28.9498 28.0274 28.0273V15.2747H29.1867C29.4942 15.2747 29.7891 15.1525 30.0065 14.9351C30.2239 14.7177 30.346 14.4228 30.346 14.1153C30.346 13.8079 30.2239 13.513 30.0065 13.2956C29.7891 13.0781 29.4942 12.956 29.1867 12.956ZM17.5934 11.7967C17.5934 11.4892 17.7155 11.1943 17.9329 10.9769C18.1503 10.7595 18.4452 10.6373 18.7527 10.6373H21.0714C21.3788 10.6373 21.6737 10.7595 21.8911 10.9769C22.1086 11.1943 22.2307 11.4892 22.2307 11.7967V12.956H17.5934V11.7967ZM25.7087 28.0273C25.7087 28.3348 25.5866 28.6297 25.3691 28.8471C25.1517 29.0645 24.8568 29.1867 24.5494 29.1867H15.2747C14.9672 29.1867 14.6723 29.0645 14.4549 28.8471C14.2375 28.6297 14.1154 28.3348 14.1154 28.0273V15.2747H25.7087V28.0273ZM22.2307 26.868C22.5382 26.868 22.833 26.7459 23.0505 26.5284C23.2679 26.311 23.39 26.0161 23.39 25.7087V18.7527C23.39 18.4452 23.2679 18.1503 23.0505 17.9329C22.833 17.7155 22.5382 17.5933 22.2307 17.5933C21.9232 17.5933 21.6283 17.7155 21.4109 17.9329C21.1935 18.1503 21.0714 18.4452 21.0714 18.7527V25.7087C21.0714 26.0161 21.1935 26.311 21.4109 26.5284C21.6283 26.7459 21.9232 26.868 22.2307 26.868Z" fill="#F0F0F0"/>
                </svg>
            </a>
            ';
        }
    ?>
</div>